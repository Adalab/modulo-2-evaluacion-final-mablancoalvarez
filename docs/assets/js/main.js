"use strict";const inputSearch=document.querySelector("#input-search"),button=document.querySelector("#button-search"),img=document.querySelector(".imgElem"),ulElement=document.querySelector("#results"),ulFav=document.querySelector(".favourites"),ulElementChild=document.querySelectorAll(".movies-list__item-info"),container=document.querySelector(".page__header");let movieList=null;const selectedMovies=readLocalStorage();function loadSeries(){ulElement.innerHTML="",fetch(`http://api.tvmaze.com/search/shows?q=${inputSearch.value}`).then(e=>e.json()).then(e=>{movieList=e,renderMovies(movieList)})}function showFavourite(){const e=document.createElement("button"),t=document.createTextNode("fav");e.appendChild(t),container.appendChild(e),e.addEventListener("click",paintFavourite)}function paintFavourite(){for(let e of selectedMovies)console.log(e.name)}function renderMovies(e){for(let t of e)null!==t.show.image?ulElement.innerHTML+=`<li id='${t.show.id}' class='movies-list__item'><div class='movies-list__item-info'><img class="imgElem" src=${t.show.image.medium} alt=${t.show.name}></div>\n            <span>${t.show.name}</span>\n            <span>${t.show.schedule.days}</span></li>`:ulElement.innerHTML+=`<li id='${t.show.id}' class='movies-list__item'><div class='movies-list__item-info'><img class="imgElem" src='https://via.placeholder.com/210x295/ffffff/666666/?text=TV' alt=${t.show.name}></div>\n            <span>${t.show.name}</span>\n            <span>${t.show.schedule.days}</span></li>`}function addListeners(){const e=document.querySelectorAll(".movies-list__item");for(let t of e)t.addEventListener("click",selectMovie)}function setLocalStorage(){localStorage.setItem("movieInfo",JSON.stringify(selectedMovies))}function readLocalStorage(){let e=JSON.parse(localStorage.getItem("movieInfo"));return null!==e?e:[]}function getMovieObject(e){return movieList.find(t=>t.show.id===parseInt(e))}function selectMovie(e){const t=e.currentTarget.id;e.currentTarget.setAttribute("class","switch");const i=getMovieObject(t),s=selectedMovies.find(e=>parseInt(e.id)===parseInt(t));null==s?(selectedMovies.push(i.show),setLocalStorage(),renderFavourites(selectedMovies)):alert("Esta serie ya estÃ¡ en favoritos")}function renderFavourites(e){ulFav.innerHTML="";for(let t of e){const e=document.createElement("li"),i=document.createElement("i"),s=document.createElement("div"),o=document.createElement("img"),n=document.createElement("span"),l=document.createTextNode(t.name);i.setAttribute("class","far fa-times-circle"),o.setAttribute("class","imgElem"),o.setAttribute("alt",t.name),null!==t.image&&void 0!==t.image&&""!==t.image?o.setAttribute("src",t.image.medium):o.setAttribute("src","https://via.placeholder.com/210x295/ffffff/666666/?text=TV"),n.appendChild(l),s.setAttribute("class","movies-list__item-info"),s.appendChild(o),s.appendChild(n),e.setAttribute("id",t.id),e.setAttribute("class","movies-list__itemFavourites"),e.appendChild(i),e.appendChild(s),ulFav.appendChild(e)}addFavouriteListeners()}function addFavouriteListeners(){const e=document.querySelectorAll("i");for(let t of e)t.addEventListener("click",removeMovie)}function removeMovie(e){const t=event.currentTarget.parentElement.getAttribute("id"),i=selectedMovies.find(e=>e.id==Number(t));let s=selectedMovies.indexOf(i);selectedMovies.splice(s,1);for(let e of ulElementChild)t===e.id&&(e.classList.remove("switch"),e.classList.add("white"));setLocalStorage(),renderFavourites(selectedMovies)}button.addEventListener("click",loadSeries),showFavourite(),renderFavourites(selectedMovies);